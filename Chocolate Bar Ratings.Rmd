---
title: "Chocolate-Bar-Ratings"
date: "`r format(Sys.Date())`"
output: github_document
---   
   
      
```{r, message=FALSE, warning=FALSE, echo=FALSE}
library(knitr)
library(dplyr)
library(tidyr)
library(ggplot2)
library(readr)
library(maps)
```    
   
      
This is a dataset of 1,700 individual chocolate bars. This dataset has information on their regional origin, percentage of cocoa, the variety of chocolate bean used and where the beans were grown. I think it would be fun to use some R code to take a look at what chocolate bar gets the highest rating over the years, what countries has the highest rated bars and what goes into getting a highly rated chocolate bar.   

   
```{r, message=FALSE, warning=FALSE, echo=FALSE}
cocoa <- read.csv("flavors_of_cacao.csv", header = T, na.strings = (""))

```   
   
A look at the data:   
```{r, message=FALSE, warning=FALSE}
kable(head(cocoa), format = "html")
```  
   
I need to remove the % sign in Cocoa.Percent and make it an int. I also want to rename some of the columns to shorter names.   

   
```{r, message=FALSE, warning=FALSE}
cocoa$Cocoa.Percent<-gsub("%","",cocoa$Cocoa.Percent)

cocoa$Cocoa.Percent <- as.integer(cocoa$Cocoa.Percent)

cocoa <- cocoa %>% rename(company = Company...Maker.if.known., 
                          bean_origin_city= Specific.Bean.Origin.or.Bar.Name, 
                          bean_origin_country = Broad.Bean.Origin, 
                          company_location = Company.Location, 
                          review_date = Review.Date, 
                          cocoa_percent = Cocoa.Percent, 
                          bean_type = Bean.Type)

str(cocoa)

```   
   
Ok now lets see a distribution of the Ratings.   
```{r}
ggplot(cocoa, aes(x = Rating)) +
      geom_histogram(color = "black", fill = "red", binwidth = .25) +
      scale_y_continuous(breaks = seq(0,400,25)) +
      labs(x = "Ratings", title = "Cocoa Ratings", y = "Count")
```    

Not bad most in the 2.5 to 4 range. The mean is `r round(mean(cocoa$Rating), 3)` and the median is `r round(median(cocoa$Rating), 3)`   

How about the distribution of the amount of cocoa in each chocolate bar.   
```{r}
ggplot(cocoa, aes(x = cocoa_percent)) +
      geom_histogram(color = "black", fill = "red", binwidth = 3) +
      scale_y_continuous(breaks = seq(0,800,50)) +
      labs(x = "Percent Cocoa", title = "The Percent of Cocoa in Each Bar", y = "Count")
```   
Ok so most companies use around 67-71 percent cocoa in there chocolate bars. The mean is `r round(mean(cocoa$cocoa_percent),2)` and the median is `r round(median(cocoa$cocoa_percent),2)`

   
  
```{r, message=FALSE, warning=FALSE, echo=FALSE}
n1 <- cocoa %>% group_by(company) %>% summarise(count = n()) %>% arrange(desc(count))
```   
   
There are `r nrow(n1)` unique companies in this dataset, lets look at the the 20 companies with the most ratings. Below is a graph of the 20 companies that have the most chocolate ratings.    

```{r}
n2 <- cocoa %>% group_by(company) %>% 
                summarise(count = n()) %>% 
                arrange(desc(count)) %>%
                top_n(20, wt = count)

ggplot(n2, aes(x = reorder(company, count),
               y = count, fill = company)) + 
                      geom_bar(stat = "identity")  +
                      geom_text(aes(label = count), vjust = 1, hjust = .5) + 
                      labs(x = "Companies", y = "Number of Ratings", title = "Companies With the most Ratings") +
                      theme(legend.position = "none") +
                      coord_flip()
```   

   
A look at where 20 most represented company location countries.   

```{r}
n3 <- cocoa %>% group_by(company_location) %>% 
                summarise(count = n()) %>% 
                arrange(desc(count)) %>%
                top_n(20, wt = count)   

ggplot(n3, aes(x = reorder(company_location, count),
               y = count, fill = company_location)) + 
                      geom_bar(stat = "identity")  +
                      geom_text(aes(label = count), vjust = 1, hjust = .5) + 
                      labs(x = "Companies", y = "Number of Ratings", title = "Companies With the most Ratings") +
                      theme(legend.position = "none") +
                      coord_flip()
```   

That is interesting the United States is while represnted in this dataset. I thought Switzerland, Germany and Belgium would have more chocolate bars rated.   
   




    
       



   
      

   










